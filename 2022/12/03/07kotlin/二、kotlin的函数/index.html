<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="二、kotlin的函数"><meta name="keywords" content="函数,命名参数,具名参数,函数参数默认值,反引号函数,顶层函数,顶层属性,常量,扩展函数,扩展属性,扩展函数没有多态性,匿名扩展函数,可空接收者,成员函数优先级大于扩展函数,中缀表达式,可变参数,vararg,正则表达式,字符串正则表达式,局部函数,局部函数扩展"><meta name="author" content="Bangiao"><meta name="copyright" content="Bangiao"><title>二、kotlin的函数 | Bangiao's Notebooks</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '6.3.0'
} </script><meta name="generator" content="Hexo 6.3.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E2%98%85"><span class="toc-number">1.</span> <span class="toc-text">函数★</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E5%90%8D%E5%8F%82%E6%95%B0-%E5%8F%88%E5%8F%AB%E5%85%B7%E5%90%8D%E5%8F%82%E6%95%B0-%E2%98%85"><span class="toc-number">1.1.</span> <span class="toc-text">命名参数(又叫具名参数) ★</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8"><span class="toc-number">1.1.1.</span> <span class="toc-text">有什么用?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E9%BB%98%E8%AE%A4%E5%80%BC-%E2%98%85"><span class="toc-number">1.2.</span> <span class="toc-text">函数参数默认值 ★</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="toc-number">1.2.1.</span> <span class="toc-text">默认函数参数的本质</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%BC%95%E5%8F%B7%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.</span> <span class="toc-text">反引号函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B6%E5%B1%82%E5%87%BD%E6%95%B0%E5%92%8C%E5%B1%9E%E6%80%A7-%E2%98%85"><span class="toc-number">1.4.</span> <span class="toc-text">顶层函数和属性 ★</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B6%E5%B1%82%E5%87%BD%E6%95%B0-%E2%98%85"><span class="toc-number">1.4.1.</span> <span class="toc-text">顶层函数 ★</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">是什么?</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B6%E5%B1%82%E5%B1%9E%E6%80%A7-%E2%98%85"><span class="toc-number">1.4.2.</span> <span class="toc-text">顶层属性 ★</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E9%87%8F-%E2%98%85"><span class="toc-number">1.4.3.</span> <span class="toc-text">常量 ★</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95-%E2%98%85"><span class="toc-number">1.5.</span> <span class="toc-text">扩展 ★</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88-%E2%98%86"><span class="toc-number">1.5.1.</span> <span class="toc-text">是什么? ☆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0-%E2%98%85"><span class="toc-number">1.5.2.</span> <span class="toc-text">扩展函数 ★</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0-%E2%98%85"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">什么是扩展函数?★</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">为什么需要扩展函数?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E7%94%A8-%E2%98%85"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">怎么用?★</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0%E7%9A%84%E6%9C%AC%E8%B4%A8%E2%98%85"><span class="toc-number">1.5.2.4.</span> <span class="toc-text">扩展函数的本质★</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">1.5.2.5.</span> <span class="toc-text">案例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0%E6%B2%A1%E6%9C%89%E5%A4%9A%E6%80%81%E6%80%A7%E2%98%85"><span class="toc-number">1.5.2.6.</span> <span class="toc-text">扩展函数没有多态性★</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7%E5%A4%A7%E4%BA%8E%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0%E2%98%85"><span class="toc-number">1.5.2.7.</span> <span class="toc-text">成员函数的优先级大于扩展函数★</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E7%A9%BA%E6%8E%A5%E6%94%B6%E8%80%85-%E4%BD%BF%E7%94%A8-Any-%E7%BB%99%E6%89%80%E6%9C%89%E5%AF%B9%E8%B1%A1%E6%B7%BB%E5%8A%A0%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0"><span class="toc-number">1.5.2.8.</span> <span class="toc-text">可空接收者(使用 Any? 给所有对象添加扩展函数)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0-%E2%98%85"><span class="toc-number">1.5.2.9.</span> <span class="toc-text">匿名扩展函数 ★</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%B1%9E%E6%80%A7-%E2%98%85"><span class="toc-number">1.5.3.</span> <span class="toc-text">扩展属性 ★</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E5%86%99"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">怎么写???</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E7%94%A8"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">怎么用?</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0-x2F-%E5%B1%9E%E6%80%A7%E8%BF%98%E5%8F%AF%E4%BB%A5%E8%BF%99%E4%B9%88%E7%90%86%E8%A7%A3"><span class="toc-number">1.6.</span> <span class="toc-text">扩展函数&#x2F;属性还可以这么理解?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.7.</span> <span class="toc-text">中缀表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89%EF%BC%9F"><span class="toc-number">1.7.1.</span> <span class="toc-text">如何定义？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0"><span class="toc-number">1.8.</span> <span class="toc-text">可变参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0-vararg"><span class="toc-number">1.8.1.</span> <span class="toc-text">可变参数: vararg</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">1.9.</span> <span class="toc-text">字符串和正则表达式的处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E9%87%8D%E5%BC%95%E5%8F%B7%E5%AD%97%E7%AC%A6%E4%B8%B2-%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8-trimMargin-%E5%B8%A6%E8%BE%B9%E7%95%8C%E7%9A%84"><span class="toc-number">1.9.1.</span> <span class="toc-text">三重引号字符串: 推荐使用 trimMargin 带边界的</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E5%87%BD%E6%95%B0%E5%92%8C%E6%89%A9%E5%B1%95"><span class="toc-number">1.10.</span> <span class="toc-text">局部函数和扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%B1%80%E9%83%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.10.1.</span> <span class="toc-text">什么是局部函数?</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://imgsa.baidu.com/forum/pic/item/c8179682d158ccbf63dc944d1bd8bc3eb03541a9.jpg"></div><div class="author-info__name text-center">Bangiao</div><div class="author-info__description text-center"></div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/bangiao">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">60</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">609</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">7</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">我的博客</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://juejin.cn/user/4248168662314823">掘金</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://blog.csdn.net/qq_30690165">CSDN</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://www.cnblogs.com/bangiao/">博客园</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://gitee.com/bangiao_admin/projects">Gitee笔记源码</a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Bangiao's Notebooks</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">首页</a><a class="site-page" href="/archives">文章列表</a><a class="site-page" href="/tags">文章标签</a><a class="site-page" href="/categories">文章分类</a><a class="site-page" href="/sources">笔记源码</a><a class="site-page" href="/about">关于</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">二、kotlin的函数</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-12-03</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/kotlin/">kotlin</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="函数★"><a href="#函数★" class="headerlink" title="函数★"></a>函数★</h1><p>自定义一个打印集合的方法</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">joinToString</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">   collection: <span class="type">Collection</span>&lt;<span class="type">T</span>&gt;,</span></span></span><br><span class="line"><span class="params"><span class="function">   separator: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">   prefix: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">   postfix: <span class="type">String</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: String &#123;</span><br><span class="line">   <span class="keyword">val</span> stringBuffer = StringBuilder(prefix)</span><br><span class="line">   <span class="keyword">for</span> ((index, value) <span class="keyword">in</span> collection.withIndex()) &#123;</span><br><span class="line">      <span class="keyword">if</span> (index &gt; <span class="number">0</span>) &#123;</span><br><span class="line">         stringBuffer.append(separator)</span><br><span class="line">      &#125;</span><br><span class="line">      stringBuffer.append(value)</span><br><span class="line">   &#125;</span><br><span class="line">   stringBuffer.append(postfix)</span><br><span class="line">   <span class="keyword">return</span> stringBuffer.toString()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="命名参数-又叫具名参数-★"><a href="#命名参数-又叫具名参数-★" class="headerlink" title="命名参数(又叫具名参数) ★"></a>命名参数(又叫具名参数) ★</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">println(joinToString(list, separator = <span class="string">&quot;,&quot;</span>, prefix = <span class="string">&quot;[ &quot;</span>, postfix = <span class="string">&quot; ]&quot;</span>))</span><br><span class="line">println(joinToString(list, separator = <span class="string">&quot;,&quot;</span>, <span class="string">&quot;[ &quot;</span>, postfix = <span class="string">&quot; ]&quot;</span>))</span><br></pre></td></tr></table></figure>

<p><code>list, separator = &quot;,&quot;, prefix = &quot;[ &quot;, postfix = &quot; ]&quot;</code></p>
<p>给参数配上了名字, 然后根据名字传递给相同名字的参数位置上</p>
<h3 id="有什么用"><a href="#有什么用" class="headerlink" title="有什么用?"></a>有什么用?</h3><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b481cdae9f9d4411914d84714ce667f5~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>反着传递参数</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bf2b5d9b56c64304a50e447314cdbcff~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>配合默认参数值, 跳过默认参数只传递下一个参数</p>
<h2 id="函数参数默认值-★"><a href="#函数参数默认值-★" class="headerlink" title="函数参数默认值 ★"></a>函数参数默认值 ★</h2><p>给函数的参数添加默认值</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">joinToString</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">   collection: <span class="type">Collection</span>&lt;<span class="type">T</span>&gt;,</span></span></span><br><span class="line"><span class="params"><span class="function">   separator: <span class="type">String</span> = <span class="string">&quot;, &quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">   prefix: <span class="type">String</span> = <span class="string">&quot;[ &quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">   postfix: <span class="type">String</span> = <span class="string">&quot; ]&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: String &#123;</span><br><span class="line">   <span class="keyword">val</span> stringBuffer = StringBuilder(prefix)</span><br><span class="line">   <span class="keyword">for</span> ((index, value) <span class="keyword">in</span> collection.withIndex()) &#123;</span><br><span class="line">      <span class="keyword">if</span> (index &gt; <span class="number">0</span>) &#123;</span><br><span class="line">         stringBuffer.append(separator)</span><br><span class="line">      &#125;</span><br><span class="line">      stringBuffer.append(value)</span><br><span class="line">   &#125;</span><br><span class="line">   stringBuffer.append(postfix)</span><br><span class="line">   <span class="keyword">return</span> stringBuffer.toString()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">separator: String = <span class="string">&quot;, &quot;</span>,</span><br><span class="line">prefix: String = <span class="string">&quot;[ &quot;</span>,</span><br><span class="line">postfix: String = <span class="string">&quot; ]&quot;</span>   </span><br></pre></td></tr></table></figure>

<p>使用默认参数值之后, 可以这样调用这种函数</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">println(joinToString(list, separator = <span class="string">&quot;,&quot;</span>, postfix = <span class="string">&quot; ]&quot;</span>))</span><br><span class="line">println(joinToString01(list, <span class="string">&quot;, &quot;</span>, postfix = <span class="string">&quot; ]&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>我们可以选择省略掉默认参数值</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0099d444987a4214be37beab07160a2e~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<h3 id="默认函数参数的本质"><a href="#默认函数参数的本质" class="headerlink" title="默认函数参数的本质"></a>默认函数参数的本质</h3><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e8ae925eac504567a86c8fad5a51f99f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>函数默认参数就是生成一个叫<code>running$default</code>的函数, 在函数体内添加 一堆 if 语句赋值默认值</p>
<blockquote>
<p>在 java 中没有默认参数值, 不过我们可以用 <code>@JvmOverloads</code>, 让一个函数生成重载函数</p>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a5b952ead27e4e3186335a80e53990eb~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JvmOverloads</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">joinToString03</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">   collection: <span class="type">Collection</span>&lt;<span class="type">T</span>&gt;,</span></span></span><br><span class="line"><span class="params"><span class="function">   separator: <span class="type">String</span> = <span class="string">&quot;, &quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">   prefix: <span class="type">String</span> = <span class="string">&quot;[ &quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">   postfix: <span class="type">String</span> = <span class="string">&quot; ]&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: String &#123;</span><br><span class="line">   <span class="keyword">val</span> stringBuffer = StringBuilder(prefix)</span><br><span class="line">   <span class="keyword">for</span> ((index, value) <span class="keyword">in</span> collection.withIndex()) &#123;</span><br><span class="line">      <span class="keyword">if</span> (index &gt; <span class="number">0</span>) &#123;</span><br><span class="line">         stringBuffer.append(separator)</span><br><span class="line">      &#125;</span><br><span class="line">      stringBuffer.append(value)</span><br><span class="line">   &#125;</span><br><span class="line">   stringBuffer.append(postfix)</span><br><span class="line">   <span class="keyword">return</span> stringBuffer.toString()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>他会生成这些函数</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/230eb821ad1d45b0a354f50bee2029e2~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>而java中每个函数的默认参数值都被省略</p>
<h2 id="反引号函数"><a href="#反引号函数" class="headerlink" title="反引号函数"></a>反引号函数</h2><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e04373113e44071adafb6c2a93f9933~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>如果函数名存在关键字或者别的不能使用的特殊字符, 可以使用 反引号</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> `<span class="keyword">fun</span>`<span class="params">()</span></span> &#123;</span><br><span class="line">   println(<span class="string">&quot;ffffff&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反引号函数还可以使用在, 只有 kotlin 才能拥有 java 不能调用的情况下</p>
<h2 id="顶层函数和属性-★"><a href="#顶层函数和属性-★" class="headerlink" title="顶层函数和属性 ★"></a>顶层函数和属性 ★</h2><blockquote>
<p>kotlin没有静态<code>static</code>关键字, 也就意味着, 没有显示的 <code>static</code> 函数或者属性, 很多人都说有, 那是伴生对象(<code>companion object</code>), 对, 那个让人看起来好像是代替java的<code>static</code>对象的, 不过本质上, 他仅仅定义了个静态类和一个静态对象罢了, 其中伴生对象的函数还是非静态的, 不过借助静态的伴生对象(静态单例对象)让其看起来像是静态函数</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">User01</span> <span class="keyword">private</span> <span class="keyword">constructor</span>(<span class="keyword">val</span> nickName: String) &#123;</span><br><span class="line">	<span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">		<span class="function"><span class="keyword">fun</span> <span class="title">newSubscribingUser</span><span class="params">(email: <span class="type">String</span>)</span></span>: User01 &#123;</span><br><span class="line">			<span class="keyword">return</span> User01(email.substringBefore(<span class="string">&#x27;@&#x27;</span>))</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反编译后</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">User01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> static <span class="keyword">final</span> Companion Companion = new Companion();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String nickName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> User01(String nickName) &#123;</span><br><span class="line">        <span class="keyword">this</span>.nickName = nickName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> String getNickName() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.nickName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> static <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Companion</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Companion() &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">final</span> User01 newSubscribingUser(String email) &#123;</span><br><span class="line">            <span class="keyword">return</span> new User01(StringsKt.substringBefore$default((String)email, (char)<span class="string">&#x27;@&#x27;</span>, <span class="literal">null</span>, (int)<span class="number">2</span>, <span class="literal">null</span>), <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>而真正的静态属性和静态函数在kotlin中被叫做顶层属性&#x2F;函数, 只不过如果没有<code>@file:JvmName(&quot;PrintCollection&quot;)</code>特意的注释文件名, 则默认顶层属性&#x2F;函数属于<code>文件名+Kt</code></p>
</blockquote>
<h3 id="顶层函数-★"><a href="#顶层函数-★" class="headerlink" title="顶层函数 ★"></a>顶层函数 ★</h3><h4 id="是什么"><a href="#是什么" class="headerlink" title="是什么?"></a>是什么?</h4><p><strong>顶层函数和顶层属性把定义的位置放在文件中, 而不是定义在类中, 该函数或者属性属于包</strong></p>
<blockquote>
<p>翻译成java代码, 该属性通常存在于 Kt 结尾的文件中</p>
</blockquote>
<blockquote>
<p>在java源码中看出顶层函数都是 static 函数</p>
</blockquote>
<p>顶层函数反编译成 java 后</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String <span class="title function_">joinToString</span><span class="params">(Collection collection, String separator, String prefix, String postfix)</span></span><br></pre></td></tr></table></figure>

<p>如果要在 java 中调用这种顶层函数</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cfc64c6703884dc989c7427ace6340e0~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="comment">// 导入了 kotlin 的文件名(文件名 + Kt)</span></span><br><span class="line"><span class="keyword">import</span> function.PrintCollectionDemoKt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        List&lt;Integer&gt; list = List.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">string</span> <span class="operator">=</span> PrintCollectionDemoKt.joinToString(list, <span class="string">&quot;, &quot;</span>, <span class="string">&quot;[ &quot;</span>, <span class="string">&quot; ]&quot;</span>);</span><br><span class="line">        System.out.println(string);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果不要以 文件名 + Kt 的形式在java中调用, 也可以在 kotlin 的文件顶上, 加上<code>@file:JvmName(&quot;PrintCollection&quot;)</code></p>
</blockquote>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d3923b5d535a4599a400b9beab3f81a5~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7fd476519e574ee4a09513721d47f1fa~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7cc321c2a8dc4802b07daf9ba5fd7c5c~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<blockquote>
<p>这里只针对顶层函数, 而不是 类</p>
</blockquote>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e57831ba0c034ba3854eb95a19bf5564~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<h3 id="顶层属性-★"><a href="#顶层属性-★" class="headerlink" title="顶层属性 ★"></a>顶层属性 ★</h3><p>顶层属性就是在文件顶层的属性, 不属于kotlin能看到的任何类中, 它属于包</p>
<blockquote>
<p>kotlin顶层函数&#x2F;顶层属性都属于全局作用域</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.100</span>) &#123;</span><br><span class="line">      count++</span><br><span class="line">   &#125;</span><br><span class="line">   println(count)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反编译成java代码看看:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">TopPropertiesDemoKt</span> &#123;</span><br><span class="line">   <span class="comment">// 看这里, static </span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> count;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">getCount</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> count;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">setCount</span><span class="params">(<span class="type">int</span> var0)</span> &#123;</span><br><span class="line">      count = var0;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">      <span class="type">int</span> <span class="variable">var1</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">byte</span> <span class="variable">var2</span> <span class="operator">=</span> <span class="number">100</span>; var1 &lt;= var2; ++var1) &#123;</span><br><span class="line">         <span class="type">int</span> <span class="variable">var10000</span> <span class="operator">=</span> count++;</span><br><span class="line">      &#125;</span><br><span class="line">      var1 = count;</span><br><span class="line">      System.out.println(var1);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果顶层属性是 <code>val</code> 定义的, 那么只会生成 <code>get</code> 方法, 我们就不能进行任何的写操作了, java源码是<code>public static final int count</code>, 他是一个常量</p>
<blockquote>
<p>Ps: 在kotlin中 <code>static</code> 不再是关键字</p>
</blockquote>
<p>var 定义的顶层属性, 如果setter 需要自定义, 可以这样:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> count = <span class="number">0</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">set</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setCount</span><span class="params">(c: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">   count = c</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>不仅仅是顶层属性可以这样, 普通类中的属于也可以, 但是主构造函数中的属性不行, 需要放在类体内定义</p>
</blockquote>
<h3 id="常量-★"><a href="#常量-★" class="headerlink" title="常量 ★"></a>常量 ★</h3><p><code>const</code> + <code>val</code>修饰 <strong>顶层属性</strong>, 将会被解析成<strong>常量</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> count = <span class="number">0</span> <span class="comment">// 顶层属性</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">val</span> INT_MAX = <span class="built_in">Int</span>.MAX_VALUE <span class="comment">// 常量</span></span><br><span class="line"><span class="keyword">val</span> INT_MIN = <span class="built_in">Int</span>.MIN_VALUE</span><br><span class="line"><span class="keyword">var</span> INT_MID = <span class="built_in">Int</span>.MIN_VALUE + <span class="built_in">Int</span>.MAX_VALUE</span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>反编译后</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> count;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">INT_MAX</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">INT_MIN</span> <span class="operator">=</span> Integer.MIN_VALUE;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">INT_MID</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line"><span class="comment">// var count = 0 // 顶层属性</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">getCount</span><span class="params">()</span> &#123; <span class="keyword">return</span> count; &#125;</span><br><span class="line"><span class="comment">// var count = 0 // 顶层属性</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">setCount</span><span class="params">(<span class="type">int</span> var0)</span> &#123; count = var0; &#125;</span><br><span class="line"><span class="comment">// val INT_MIN = Int.MIN_VALUE</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">getINT_MIN</span><span class="params">()</span> &#123; <span class="keyword">return</span> INT_MIN; &#125;</span><br><span class="line"><span class="comment">// var INT_MID = Int.MIN_VALUE + Int.MAX_VALUE</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">getINT_MID</span><span class="params">()</span> &#123; <span class="keyword">return</span> INT_MID; &#125;</span><br><span class="line"><span class="comment">// var INT_MID = Int.MIN_VALUE + Int.MAX_VALUE</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">setINT_MID</span><span class="params">(<span class="type">int</span> var0)</span> &#123; INT_MID = var0; &#125;</span><br></pre></td></tr></table></figure>


<p>(1) 常量不能放在类的内部, 他只能属于<code>顶层</code>或者<code>伴生对象</code>(有点像<code>静态代码块</code>)</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">val</span> INT_MIN = <span class="built_in">Int</span>.MIN_VALUE</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> <span class="keyword">val</span> INT_MAX = <span class="built_in">Int</span>.MAX_VALUE</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/df60ddfda9d44f59982bc6828d7eb831~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<h2 id="扩展-★"><a href="#扩展-★" class="headerlink" title="扩展 ★"></a>扩展 ★</h2><h3 id="是什么-☆"><a href="#是什么-☆" class="headerlink" title="是什么? ☆"></a>是什么? ☆</h3><p>扩展包含 <code>扩展函数</code> 和 <code>扩展属性</code>, 第三方库中的类通常不让修改, 但可以使用 <strong>扩展函数(扩展属性)为第三方库添加新的函数和属性, 不需要修改库源码</strong></p>
<h3 id="扩展函数-★"><a href="#扩展函数-★" class="headerlink" title="扩展函数 ★"></a>扩展函数 ★</h3><h4 id="什么是扩展函数-★"><a href="#什么是扩展函数-★" class="headerlink" title="什么是扩展函数?★"></a>什么是扩展函数?★</h4><p>扩展函数对类进行扩展, 不需要修改类中任何源码, 仅需要给函数添加 receiver 便可</p>
<h4 id="为什么需要扩展函数"><a href="#为什么需要扩展函数" class="headerlink" title="为什么需要扩展函数?"></a>为什么需要扩展函数?</h4><p>库中代码无法修改, 此时可以通过扩展函数扩展该库特定类的功能</p>
<h4 id="怎么用-★"><a href="#怎么用-★" class="headerlink" title="怎么用?★"></a>怎么用?★</h4><p>非常简单, 扩展函数说到底还是函数, 可以按照普通函数写</p>
<ol>
<li>写个函数</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">last01</span><span class="params">()</span></span>: <span class="built_in">Char</span> &#123; <span class="keyword">return</span> xxx &#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>加上扩展的类(<code>receiver</code>)</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">last01</span><span class="params">()</span></span>: <span class="built_in">Char</span> &#123; <span class="keyword">return</span> <span class="keyword">this</span>[<span class="keyword">this</span>.length - <span class="number">1</span>] &#125;</span><br></pre></td></tr></table></figure>

<p>至此扩展函数写完了</p>
<p>该扩展函数给 <code>String</code> 类添加了 <code>last01</code> 函数</p>
<ol start="3">
<li>调用扩展函数</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    println(<span class="string">&quot;<span class="subst">$&#123;<span class="string">&quot;zhazha&quot;</span>.last01()&#125;</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="扩展函数的本质★"><a href="#扩展函数的本质★" class="headerlink" title="扩展函数的本质★"></a>扩展函数的本质★</h4><p>扩展函数的本质: <code>fun String.print(): Char</code> &#x3D;&#x3D;&gt; <code>fun print(str: String): Char</code></p>
<blockquote>
<p>对扩展函数的本质是: <code>fun print(str: String): Char</code>, 记住这点, 后续遇到的任何问题都可以解释</p>
</blockquote>
<p>反编译代码:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> char last01(String $<span class="keyword">this</span>$last01) &#123;</span><br><span class="line">    <span class="keyword">return</span> $<span class="keyword">this</span>$last01.charAt($<span class="keyword">this</span>$last01.length() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从 <code>String.last01(): Char</code> 变成了 <code>char last01(String this)</code>, 这便是 kotlin 编译器为扩展函数做的处理</p>
<p>因此可如下使用:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> void test01() &#123;</span><br><span class="line">    println(<span class="string">&quot;<span class="subst">$&#123;last01(<span class="string">&quot;zhazha&quot;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>此后遇见扩展函数便可看成: <code>Int.xxx()</code> &#x3D;&#x3D;&gt; <code>xxx(this: Int)</code></p>
<p>由此推导: <code>Int() -&gt; Char &lt;==&gt; (Int) -&gt; Char</code> 可相互转换使用</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">last01</span><span class="params">()</span></span>: <span class="built_in">Char</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">this</span>[<span class="keyword">this</span>.length - <span class="number">1</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="keyword">val</span> vLast: (String) -&gt; <span class="built_in">Char</span> = String::last01</span><br><span class="line">   vLast(<span class="string">&quot;zhazha&quot;</span>)</span><br><span class="line">   <span class="keyword">val</span> extLast: String.() -&gt; <span class="built_in">Char</span> = vLast</span><br><span class="line">   <span class="string">&quot;zhazha&quot;</span>.extLast()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>String.() -&gt; Char</code> 和 <code>(String) -&gt; Char</code> 相互转换</p>
<blockquote>
<p>注意:扩展函数可以以 <code>String::last01</code> 如此形式获取扩展函数引用</p>
</blockquote>
<blockquote>
<p>如若出现扩展函数与扩展属性同名时, <code>String::last01</code>默认引用成员函数</p>
</blockquote>
<h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><blockquote>
<p>效仿 <code>with</code> 标准函数复写一个属于自己的 <code>with</code> 扩展函数</p>
</blockquote>
<p>参考标准库代码如下:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@kotlin</span>.<span class="keyword">internal</span>.InlineOnly</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> <span class="title">with</span><span class="params">(receiver: <span class="type">T</span>, block: <span class="type">T</span>.() -&gt; <span class="type">R</span>)</span></span>: R &#123;</span><br><span class="line">    contract &#123;</span><br><span class="line">        callsInPlace(block, InvocationKind.EXACTLY_ONCE)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> receiver.block()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以效仿模拟出两种写法:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;A, B&gt;</span> A.<span class="title">with01</span><span class="params">(block: <span class="type">A</span>.() -&gt; <span class="type">B</span>)</span></span> = <span class="keyword">this</span>.block()</span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;A, B&gt;</span> A.<span class="title">with02</span><span class="params">(block: (<span class="type">A</span>) -&gt; <span class="type">B</span>)</span></span> = block(<span class="keyword">this</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">test02</span><span class="params">()</span></span> &#123;</span><br><span class="line">   println(<span class="string">&quot;zhazha&quot;</span>.with01 &#123; <span class="comment">// this -&gt;</span></span><br><span class="line">      <span class="keyword">this</span>.length</span><br><span class="line">   &#125;)</span><br><span class="line">   println(<span class="string">&quot;zhazha&quot;</span>.with02 &#123; <span class="comment">// it -&gt;</span></span><br><span class="line">      it.length</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>依据前面的总结, 在此处还可认为: <code>A.() -B</code> 与 <code>(A) -&gt; B</code>有着相同的效果</p>
<p>只不过使用的方式不同, 前者可以使用 <code>this</code> 后者 使用<code>it</code></p>
<h4 id="扩展函数没有多态性★"><a href="#扩展函数没有多态性★" class="headerlink" title="扩展函数没有多态性★"></a>扩展函数没有多态性★</h4><p>扩展函数的调用实际上不走底层java多态那一套, 是编译器在操作</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="keyword">class</span> <span class="title class_">Shape</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Rectangle</span>: <span class="type">Shape</span>() &#123;&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Triangle</span>: <span class="type">Shape</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> Shape.<span class="title">getName</span><span class="params">()</span></span> = <span class="string">&quot;Shape = <span class="subst">$&#123;s.javaClass&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> Rectangle.<span class="title">getName</span><span class="params">()</span></span> = <span class="string">&quot;Rectangle&quot;</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> Triangle.<span class="title">getName</span><span class="params">()</span></span> = <span class="string">&quot;Triangle&quot;</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">printName</span><span class="params">(s: <span class="type">Shape</span>)</span></span> = println(s.getName())</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">test01</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="keyword">val</span> s = Shape()</span><br><span class="line">   printName(s)</span><br><span class="line">   <span class="keyword">val</span> r = Rectangle()</span><br><span class="line">   printName(r)</span><br><span class="line">   <span class="keyword">val</span> t = Triangle()</span><br><span class="line">   printName(t)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Shape</span><br><span class="line">Shape</span><br><span class="line">Shape</span><br></pre></td></tr></table></figure>



<p>要记住, 扩展函数的原型是这样:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getName</span><span class="params">(s: <span class="type">Shape</span>)</span></span> = <span class="string">&quot;Shape class = <span class="subst">$&#123;s.javaClass&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getName</span><span class="params">(r: <span class="type">Rectangle</span>)</span></span> = <span class="string">&quot;Rectangle&quot;</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getName</span><span class="params">(t: <span class="type">Triangle</span>)</span></span> = <span class="string">&quot;Triangle&quot;</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">printName</span><span class="params">(s: <span class="type">Shape</span>)</span></span> = println(getName(s))</span><br></pre></td></tr></table></figure>



<p>在执行这段代码<code>fun printName(s: Shape) = println(getName(s))</code>时, <code>getName(s)</code>调用的是 <code>fun getName(s: Shape)</code> 这个函数</p>
<p>这是简单的函数调用不是对象的方法调用</p>
<p>对象的方法调用才有多态, 函数调用不存在 <code>虚函数指针</code> 和<code>虚函数表</code>, 对象才有</p>
<p>除非代码改成这样:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="keyword">class</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">   <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">getName</span><span class="params">()</span></span>: String = <span class="string">&quot;Shape&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Rectangle</span>: <span class="type">Shape</span>() &#123;</span><br><span class="line">   <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getName</span><span class="params">()</span></span>: String = <span class="string">&quot;Rectangle&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Triangle</span>: <span class="type">Shape</span>() &#123;</span><br><span class="line">   <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getName</span><span class="params">()</span></span>: String = <span class="string">&quot;Triangle&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">printName</span><span class="params">(s: <span class="type">Shape</span>)</span></span> = println(s.getName())</span><br></pre></td></tr></table></figure>



<p>所以不要被扩展函数的 <code>s.getName()</code> 误导了, 其本质上是<code>getName(s)</code> 是函数调用</p>
<p>类对象的 <code>s.getName()</code>才会有多态</p>
<h4 id="成员函数的优先级大于扩展函数★"><a href="#成员函数的优先级大于扩展函数★" class="headerlink" title="成员函数的优先级大于扩展函数★"></a>成员函数的优先级大于扩展函数★</h4><p>当类中存在的一个函数和扩展函数有这相同的函数签名, 那么kotlin编译器会优先选择成员函数, 如果扩展函数和成员函数的函数签名不同时, 则不会收到任何影响</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Example</span> &#123;</span><br><span class="line">   <span class="function"><span class="keyword">fun</span> <span class="title">printFunctionType</span><span class="params">()</span></span> = println(<span class="string">&quot;class Method&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> Example.<span class="title">printFunctionType</span><span class="params">()</span></span> = println(<span class="string">&quot;extension method&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">   <span class="keyword">val</span> example = Example()</span><br><span class="line">   example.printFunctionType() <span class="comment">// class Method</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="可空接收者-使用-Any-给所有对象添加扩展函数"><a href="#可空接收者-使用-Any-给所有对象添加扩展函数" class="headerlink" title="可空接收者(使用 Any? 给所有对象添加扩展函数)"></a>可空接收者(使用 <code>Any?</code> 给所有对象添加扩展函数)</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> Any?.<span class="title">toString</span><span class="params">()</span></span>: String = <span class="keyword">if</span> (<span class="keyword">this</span> == <span class="literal">null</span>) <span class="string">&quot;null&quot;</span> <span class="keyword">else</span> toString()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上面这段代码可以简化, 看来我kotlin能力还是不行, 想到了可以用 ?: 表达式, 可是脑抽了, 用了 if 表达式, 上了 idea 才知道还能这样写, 失策失策~~~</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> Any?.<span class="title">toString</span><span class="params">()</span></span>: String = <span class="keyword">this</span>?.toString() ?: <span class="string">&quot;null&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>Any?</code>是 kotlin 中所有类的父类, 给 <code>Any?</code> 添加扩展函数则是给所有类添加了一个函数</p>
<h4 id="匿名扩展函数-★"><a href="#匿名扩展函数-★" class="headerlink" title="匿名扩展函数 ★"></a>匿名扩展函数 ★</h4><table>
<thead>
<tr>
<th>匿名扩展函数如何定义?</th>
</tr>
</thead>
<tbody><tr>
<td>函数?</td>
</tr>
<tr>
<td><code>fun print(): Char</code></td>
</tr>
<tr>
<td>匿名?</td>
</tr>
<tr>
<td><code>fun (): Char</code></td>
</tr>
<tr>
<td>扩展?</td>
</tr>
<tr>
<td><code>fun receiver.(): Char</code></td>
</tr>
</tbody></table>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> c: String.() -&gt; <span class="built_in">Char</span> = <span class="function"><span class="keyword">fun</span> String.<span class="params">()</span></span>: <span class="built_in">Char</span> = <span class="keyword">this</span>[<span class="keyword">this</span>.length - <span class="number">1</span>]</span><br><span class="line"><span class="string">&quot;zhazha&quot;</span>.c()</span><br></pre></td></tr></table></figure>

<p>可以变成: </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> c: String.() -&gt; <span class="built_in">Char</span> = &#123; <span class="keyword">this</span>[<span class="keyword">this</span>.length - <span class="number">1</span>] &#125;</span><br></pre></td></tr></table></figure>

<p>再加强一点点, 把他变成参数呢? <code>匿名扩展函数类型参数</code></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">last03</span><span class="params">(str: <span class="type">String</span>, last: <span class="type">String</span>.() -&gt; <span class="type">Char</span>)</span></span> &#123;</span><br><span class="line">   last(str)</span><br><span class="line">   str.last()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span> <span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> toC: String.() -&gt; <span class="built_in">Char</span> = <span class="function"><span class="keyword">fun</span> String.<span class="params">()</span></span>: <span class="built_in">Char</span> = <span class="keyword">this</span>[<span class="keyword">this</span>.length - <span class="number">1</span>]</span><br><span class="line">    <span class="string">&quot;zhazha&quot;</span>.toC()</span><br><span class="line">    last03(<span class="string">&quot;zhazha&quot;</span>, <span class="function"><span class="keyword">fun</span> String.<span class="params">()</span></span>: <span class="built_in">Char</span> = <span class="keyword">this</span>[<span class="keyword">this</span>.length - <span class="number">1</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>java源码: </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">last03</span><span class="params">(String str, Function1&lt;? <span class="built_in">super</span> String, Character&gt; last)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Function1</span> <span class="variable">toC2</span> <span class="operator">=</span> main.toC<span class="number">.1</span>.INSTANCE;</span><br><span class="line">toC2.invoke((Object)<span class="string">&quot;zhazha&quot;</span>);</span><br><span class="line">ExtensionFuncPropertyDemoKt.last03(<span class="string">&quot;zhazha&quot;</span>, (Function1&lt;? <span class="built_in">super</span> String, Character&gt;)((Function1)main<span class="number">.1</span>.INSTANCE));</span><br></pre></td></tr></table></figure>

<p><strong>匿名扩展函数对象</strong>不论作为变量还是参数都被kotlin定义成了 <code>Function1</code></p>
<blockquote>
<p>记住仅仅是对扩展函数的 变量 和 参数, 和定义的扩展函数无关</p>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cfd1c1148b62401092e3ecf507264708~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p><code>Function1</code> 接口, 看到 <code>in</code> 和 <code>out</code> 了么? 有进, 有出. <code>p1 进</code>, <code>R 出</code></p>
<blockquote>
<p>如果有学过 java 的话 , 你就把 <code>last</code> 当作接口<code>Function1</code>的匿名对象(<code>Function1</code>的子类), 而匿名对象里面有个 <code>invoke</code> 函数</p>
</blockquote>
<p>上面那段代码还可以这样写</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">last03</span><span class="params">(str: <span class="type">String</span>, last: <span class="type">String</span>.() -&gt; <span class="type">Char</span>)</span></span> &#123;</span><br><span class="line">   str.last()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>它<strong>既是的匿名对象 也是 扩展函数</strong>, 这点需要注意</p>
<p>回到 <code>last03</code> 函数的调用</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">last03</span><span class="params">(str: <span class="type">String</span>, last: <span class="type">String</span>.() -&gt; <span class="type">Char</span>)</span></span> &#123;</span><br><span class="line">   str.last()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>它的调用: </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last03(<span class="string">&quot;zhazha&quot;</span>, <span class="function"><span class="keyword">fun</span> String.<span class="params">()</span></span>: <span class="built_in">Char</span> = <span class="keyword">this</span>[<span class="keyword">this</span>.length - <span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p>第二个参数是 <strong>匿名扩展函数</strong>, 那要怎么把第二个参数变成 传递 <strong>lambda</strong> 呢?</p>
<p>在 kotlin 中, lambda 表达式是以 <code>&#123;&#125;</code> 标识作用域, 使用 <code>-&gt;</code> 区分 参数 和 函数体 的表达式, 所以先写上 <code>&#123;&#125;</code></p>
<p>发现idea报错提示</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c84950d268f04da08bde8ec86c38bf91~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p>
<p>你听了它的话 <code>last03</code> 函数声明就变成:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">last</span><span class="params">(str: <span class="type">String</span>, param: <span class="type">String</span>.() -&gt; <span class="type">Unit</span>)</span></span> = str.param()</span><br></pre></td></tr></table></figure>

<p>从 <code>Char</code> 变成 <code>Unit</code></p>
<p>然后函数调用就变成这样: </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last(<span class="string">&quot;xixi&quot;</span>) &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>懂了吧? 改回原先的代码, 试试返回个 <strong>Char</strong> 看看</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last(<span class="string">&quot;xixi&quot;</span>) &#123; <span class="string">&#x27;a&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>

<p>没报错</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">last</span><span class="params">(str: <span class="type">String</span>, param: <span class="type">String</span>.() -&gt; <span class="type">Char</span>)</span></span> = str.param()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    last(<span class="string">&quot;xixi&quot;</span>) &#123; <span class="comment">// this: String // 这里隐藏着一个 this</span></span><br><span class="line">        <span class="keyword">this</span>.last()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>★ 总结: 这说明了 <code>String.() -&gt; Char</code> 转成 lambda 表达式的话, 可以 不用管 <strong>接收者</strong> 是怎样, 相当于写一个 <code>() -&gt; Char</code> 要怎么转成lambda就行, 只不过 lambda 作用域内多了个 <code>this</code>, 该对象由 我们主动以 <code>str.param()</code> 形式调用，被 kotlin 编译器识别注入了<code>receiver</code> 罢了</p>
</blockquote>
<p>如果上面的解释看不懂, 理解不了</p>
<p>我们可以将其还原成: <code>fun last(str: String, param: String.() -&gt; Char) = str.param()</code></p>
<p>这样我们可以这么使用:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">last(<span class="string">&quot;xixi&quot;</span>) &#123; it -&gt; <span class="comment">// 这是自带的</span></span><br><span class="line">    it.last()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>匿名扩展函数 <code>String.(): Char</code> 也就是 <code>(String): Char</code></p>
</blockquote>
<h3 id="扩展属性-★"><a href="#扩展属性-★" class="headerlink" title="扩展属性 ★"></a>扩展属性 ★</h3><p>它是一个属性, 有 <strong>get&#x2F;set</strong> 方法, 没有字段(field)</p>
<h4 id="怎么写"><a href="#怎么写" class="headerlink" title="怎么写???"></a>怎么写???</h4><p>既然是扩展的属性, 核心是属性</p>
<p>(1) 先写个字段</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> count: <span class="built_in">Int</span> = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>(2) 加上扩展</p>
<p>这里的扩展我选择 <code>List&lt;Int&gt;</code></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> List&lt;<span class="built_in">Int</span>&gt;.count: <span class="built_in">Int</span></span><br></pre></td></tr></table></figure>

<p>(3) 最后加上自定义访问器(get&#x2F;set)</p>
<p>由于这里是 val 修饰, 所以只有 get 没有 set 访问器</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> List&lt;<span class="built_in">Int</span>&gt;.count: <span class="built_in">Int</span></span><br><span class="line">    <span class="keyword">get</span>() = <span class="keyword">this</span>.size</span><br></pre></td></tr></table></figure>

<p>完成</p>
<h4 id="怎么用"><a href="#怎么用" class="headerlink" title="怎么用?"></a>怎么用?</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>)</span><br><span class="line">println(list.count)</span><br></pre></td></tr></table></figure>

<p>翻译成java源码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">ExtensionPropertiesDemoKt</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">getCount</span><span class="params">(List&lt;Integer&gt; count)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> count.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Object[] arrobject = <span class="keyword">new</span> <span class="title class_">Integer</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>&#125;;</span><br><span class="line">        <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> CollectionsKt.listOf((Object[])arrobject);</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> ExtensionPropertiesDemoKt.getCount(list);</span><br><span class="line">        System.out.println(n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>学完扩展函数, 再学扩展属性就简单过下完事</p>
</blockquote>
<h2 id="扩展函数-x2F-属性还可以这么理解"><a href="#扩展函数-x2F-属性还可以这么理解" class="headerlink" title="扩展函数&#x2F;属性还可以这么理解?"></a>扩展函数&#x2F;属性还可以这么理解?</h2><p>你可以认为扩展函数&#x2F;属性就是往函数或者属性的作用域中添加一个<code>receiver</code>对象</p>
<p>比如: </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">first</span><span class="params">()</span></span>: <span class="built_in">Char</span> = <span class="keyword">this</span>[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>



<p>就是往一个 <code>first</code> 的函数作用域内添加一个 <code>String</code> 类型的对象</p>
<p>接着你就可以在该函数的作用域中使用 <code>String</code> 对象</p>
<h2 id="中缀表达式"><a href="#中缀表达式" class="headerlink" title="中缀表达式"></a>中缀表达式</h2><p>上面的 <code>in、step、downTo和until</code> 这些可以不通过点号调用的函数， 就是传说中的中缀表达式</p>
<h3 id="如何定义？"><a href="#如何定义？" class="headerlink" title="如何定义？"></a>如何定义？</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">infix</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;A, B&gt;</span> A.<span class="title">to</span><span class="params">(that: <span class="type">B</span>)</span></span>: Pair&lt;A, B&gt;</span><br></pre></td></tr></table></figure>



<p><code>A to B</code> &#x3D;&#x3D;&gt; <code>A + 中缀表达式名字 + B</code></p>
<p>中缀表达式必须满足:</p>
<ol>
<li>必须是某个类型的扩展函数或成员函数</li>
<li>中缀表达式函数只能有一个函数</li>
<li>中缀表达式不能有默认参数值</li>
<li>中缀表达式参数不能是可变参数</li>
</ol>
<p>可以自己实现一个，比如 函数名叫 <code>vs</code></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Score</span>(<span class="keyword">val</span> name: String, <span class="keyword">var</span> score: <span class="built_in">Double</span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">infix</span> <span class="function"><span class="keyword">fun</span> Score.<span class="title">vs</span><span class="params">(other: <span class="type">Score</span>)</span></span>: String = <span class="keyword">when</span> &#123;</span><br><span class="line">   <span class="keyword">this</span>.score &gt; other.score -&gt; <span class="string">&quot;congratulations！！！ <span class="subst">$&#123;this.name&#125;</span>: <span class="subst">$&#123;this.score&#125;</span> win！！！&quot;</span></span><br><span class="line">   <span class="keyword">this</span>.score == other.score -&gt; <span class="string">&quot;<span class="subst">$&#123;this.name&#125;</span> and <span class="subst">$&#123;other.score&#125;</span> have the same score！！！&quot;</span></span><br><span class="line">   <span class="keyword">else</span> -&gt; <span class="string">&quot;congratulations！！！<span class="subst">$&#123;other.name&#125;</span>: <span class="subst">$&#123;other.score&#125;</span> win！！！&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="keyword">val</span> xiaoMing = Score(<span class="string">&quot;xiangming&quot;</span>, <span class="number">98.5</span>)</span><br><span class="line">   <span class="keyword">val</span> xiaoHong = Score(<span class="string">&quot;xiaoHong&quot;</span>, <span class="number">99.0</span>)</span><br><span class="line">   println(xiaoMing vs xiaoHong)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>还可以这么写</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Score</span>(<span class="keyword">val</span> name: String, <span class="keyword">var</span> score: <span class="built_in">Double</span>) &#123;</span><br><span class="line">   <span class="keyword">infix</span> <span class="function"><span class="keyword">fun</span> <span class="title">vs</span><span class="params">(other: <span class="type">Score</span>)</span></span>: String = <span class="keyword">when</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.score &gt; other.score -&gt; <span class="string">&quot;congratulations！！！ <span class="subst">$&#123;this.name&#125;</span>: <span class="subst">$&#123;this.score&#125;</span> win！！！&quot;</span></span><br><span class="line">      <span class="keyword">this</span>.score == other.score -&gt; <span class="string">&quot;<span class="subst">$&#123;this.name&#125;</span> and <span class="subst">$&#123;other.score&#125;</span> have the same score！！！&quot;</span></span><br><span class="line">      <span class="keyword">else</span> -&gt; <span class="string">&quot;congratulations！！！<span class="subst">$&#123;other.name&#125;</span>: <span class="subst">$&#123;other.score&#125;</span> win！！！&quot;</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="keyword">val</span> xiaoMing = Score(<span class="string">&quot;xiangming&quot;</span>, <span class="number">98.5</span>)</span><br><span class="line">   <span class="keyword">val</span> xiaoHong = Score(<span class="string">&quot;xiaoHong&quot;</span>, <span class="number">99.0</span>)</span><br><span class="line">   println(xiaoMing vs xiaoHong)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>中缀表达式还支持函数调用方式调用, 只需要:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xiaoMing.vs(xiaoHong)</span><br></pre></td></tr></table></figure>







<p>经常会看到 我们在遍历 map 的时候会这样： </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>((index, value) <span class="keyword">in</span> map) &#123;</span><br><span class="line">    println(<span class="string">&quot;index = <span class="subst">$&#123;index&#125;</span>, value = <span class="subst">$&#123;value&#125;</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>不对， 这是解构，不是中缀， 虽然他有 <code>toPair</code> 函数</p>
</blockquote>
<h2 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h2><h3 id="可变参数-vararg"><a href="#可变参数-vararg" class="headerlink" title="可变参数: vararg"></a>可变参数: <code>vararg</code></h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">arrOf</span><span class="params">(<span class="keyword">vararg</span> arr: <span class="type">Int</span>)</span></span>: Array&lt;<span class="built_in">Int</span>&gt; &#123;</span><br><span class="line">   <span class="keyword">return</span> arr.toTypedArray()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> arr = arrOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">arr.forEach &#123; println(it) &#125;</span><br></pre></td></tr></table></figure>



<p>我们可以使用 <code>* 星号</code>来传入外部变量作为可变参数的变量</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> arr = arrOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">arrOf(*arr.toIntArray())</span><br></pre></td></tr></table></figure>





<h2 id="字符串和正则表达式的处理"><a href="#字符串和正则表达式的处理" class="headerlink" title="字符串和正则表达式的处理"></a>字符串和正则表达式的处理</h2><h3 id="三重引号字符串-推荐使用-trimMargin-带边界的"><a href="#三重引号字符串-推荐使用-trimMargin-带边界的" class="headerlink" title="三重引号字符串: 推荐使用 trimMargin 带边界的"></a>三重引号字符串: 推荐使用 <code>trimMargin</code> 带边界的</h3><p><code>&quot;&quot;&quot;zhazha&quot;&quot;&quot;</code> 这就是三重引用字符串</p>
<ol>
<li>三重引号中的字符串不需要进行字符串转义</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">parsePath</span><span class="params">(path: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">   <span class="comment">// 文件目录</span></span><br><span class="line">   <span class="keyword">val</span> directory = path.substringBeforeLast(<span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span>)</span><br><span class="line">   <span class="comment">// 文件名+扩展名</span></span><br><span class="line">   <span class="keyword">val</span> fullName = path.substringAfterLast(<span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span>)</span><br><span class="line">   <span class="comment">// 获取文件名</span></span><br><span class="line">   <span class="keyword">val</span> fileName = fullName.substringBefore(<span class="string">&quot;&quot;&quot;.&quot;&quot;&quot;</span>)</span><br><span class="line">   <span class="comment">// 获取扩展名</span></span><br><span class="line">   <span class="keyword">val</span> extension = fullName.substringAfter(<span class="string">&quot;&quot;&quot;.&quot;&quot;&quot;</span>)</span><br><span class="line">   println(<span class="string">&quot;文件目录: <span class="variable">$directory</span> \nfullName: <span class="variable">$fullName</span> \n文件名: <span class="variable">$fileName</span> \n扩展名: <span class="variable">$extension</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">parsePathRegex</span><span class="params">(path: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">   <span class="keyword">val</span> regex = <span class="string">&quot;&quot;&quot;(.+)\(.+).(.+)&quot;&quot;&quot;</span>.toRegex()</span><br><span class="line">   <span class="keyword">val</span> matchResult = regex.matchEntire(path)</span><br><span class="line">   <span class="keyword">if</span> (<span class="literal">null</span> != matchResult) &#123;</span><br><span class="line">      <span class="keyword">val</span> (directory, fileName, extension) = matchResult.destructured</span><br><span class="line">      println(matchResult.destructured.toList().toString())</span><br><span class="line">      println(<span class="string">&quot;文件目录: <span class="variable">$directory</span> \nfileName: <span class="variable">$fileName</span>\n扩展名: <span class="variable">$extension</span>&quot;</span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">   <span class="keyword">val</span> path = <span class="string">&quot;&quot;&quot;D:\programs\codes\java\autoShutdown\src\test\java\com\zhazha\test\FooBar.java&quot;&quot;&quot;</span></span><br><span class="line">   parsePathRegex(path)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>三重字符串的第二个功能</li>
</ol>
<p>被包围的字符串, 保留换行符, 各种奇奇怪怪的符号</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">         ddddddddd</span></span><br><span class="line"><span class="string">         ggg</span></span><br><span class="line"><span class="string">         </span></span><br><span class="line"><span class="string">      hhhhhhhhh</span></span><br><span class="line"><span class="string">            wwwwwwwww</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">println(str)</span><br></pre></td></tr></table></figure>


<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	ddddddddd</span><br><span class="line">   ggg</span><br><span class="line">   </span><br><span class="line">hhhhhhhhh</span><br><span class="line">      wwwwwwwww</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>去除每一行前面共同的缩进</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">&quot;&quot;&quot;            ddddddddd</span></span><br><span class="line"><span class="string">         ggg\n</span></span><br><span class="line"><span class="string">         </span></span><br><span class="line"><span class="string">      hhhhhhhhh</span></span><br><span class="line"><span class="string">            wwwwwwwww&quot;&quot;&quot;</span>.trimIndent()</span><br><span class="line"></span><br><span class="line">println(str)</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">	ddddddddd</span><br><span class="line">   ggg\n</span><br><span class="line">   </span><br><span class="line">hhhhhhhhh</span><br><span class="line">      wwwwwwwww</span><br></pre></td></tr></table></figure>

<p>去除边界前缀之前的所有字符</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">&quot;&quot;&quot;            .ddddddddd</span></span><br><span class="line"><span class="string">         .ggg\n</span></span><br><span class="line"><span class="string">         .</span></span><br><span class="line"><span class="string">     .hhhhhhhhh</span></span><br><span class="line"><span class="string">            .wwwwwwwww&quot;&quot;&quot;</span>.trimMargin(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">println(str)</span><br></pre></td></tr></table></figure>

<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ddddddddd</span><br><span class="line">ggg\n</span><br><span class="line"></span><br><span class="line">hhhhhhhhh</span><br><span class="line">wwwwwwwww</span><br></pre></td></tr></table></figure>

<p><code>trimMargin</code>函数默认使用<code>|</code>做边界前缀, 上面代码使用的<code>.</code>做边界前缀</p>
<h2 id="局部函数和扩展"><a href="#局部函数和扩展" class="headerlink" title="局部函数和扩展"></a>局部函数和扩展</h2><h3 id="什么是局部函数"><a href="#什么是局部函数" class="headerlink" title="什么是局部函数?"></a>什么是局部函数?</h3><p>在函数中写上函数</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">saveUser</span><span class="params">(user: <span class="type">User</span>)</span></span> &#123;</span><br><span class="line">   <span class="function"><span class="keyword">fun</span> <span class="title">validate</span><span class="params">(user: <span class="type">User</span>, value: <span class="type">String</span>, fieldName: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (value.isEmpty()) &#123;</span><br><span class="line">         <span class="keyword">throw</span> IllegalArgumentException(<span class="string">&quot;can&#x27;t save user <span class="subst">$&#123;user.id&#125;</span>: empty <span class="variable">$fieldName</span>&quot;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   validate(user, user.name, <span class="string">&quot;name&quot;</span>)</span><br><span class="line">   validate(user, user.address, <span class="string">&quot;address&quot;</span>)</span><br><span class="line">   println(user)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反编译成 java</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> static <span class="keyword">final</span> void saveUser(User user) &#123;</span><br><span class="line">    Intrinsics.checkNotNullParameter((Object)user, (String)<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    LocalFuncDemo01Kt.saveUser$validate(user, user.getName(), <span class="string">&quot;name&quot;</span>);</span><br><span class="line">    LocalFuncDemo01Kt.saveUser$validate(user, user.getAddress(), <span class="string">&quot;address&quot;</span>);</span><br><span class="line">    boolean bl = <span class="literal">false</span>;</span><br><span class="line">    System.<span class="keyword">out</span>.println(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> static <span class="keyword">final</span> void saveUser$validate(User user, String value, String fieldName) &#123;</span><br><span class="line">    CharSequence charSequence = value;</span><br><span class="line">    boolean bl = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (charSequence.length() == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> new IllegalArgumentException(<span class="string">&quot;can&#x27;t save user &quot;</span> + user.getId() + <span class="string">&quot;: empty &quot;</span> + fieldName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>没找到应用场景, 看起来也挺麻烦的, 目前对我来说没啥用</p>
</blockquote>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Bangiao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://bangiao.github.io/2022/12/03/07kotlin/二、kotlin的函数/">https://bangiao.github.io/2022/12/03/07kotlin/二、kotlin的函数/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%87%BD%E6%95%B0/">函数</a><a class="post-meta__tags" href="/tags/%E5%91%BD%E5%90%8D%E5%8F%82%E6%95%B0/">命名参数</a><a class="post-meta__tags" href="/tags/%E5%85%B7%E5%90%8D%E5%8F%82%E6%95%B0/">具名参数</a><a class="post-meta__tags" href="/tags/%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E9%BB%98%E8%AE%A4%E5%80%BC/">函数参数默认值</a><a class="post-meta__tags" href="/tags/%E5%8F%8D%E5%BC%95%E5%8F%B7%E5%87%BD%E6%95%B0/">反引号函数</a><a class="post-meta__tags" href="/tags/%E9%A1%B6%E5%B1%82%E5%87%BD%E6%95%B0/">顶层函数</a><a class="post-meta__tags" href="/tags/%E9%A1%B6%E5%B1%82%E5%B1%9E%E6%80%A7/">顶层属性</a><a class="post-meta__tags" href="/tags/%E5%B8%B8%E9%87%8F/">常量</a><a class="post-meta__tags" href="/tags/%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0/">扩展函数</a><a class="post-meta__tags" href="/tags/%E6%89%A9%E5%B1%95%E5%B1%9E%E6%80%A7/">扩展属性</a><a class="post-meta__tags" href="/tags/%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0%E6%B2%A1%E6%9C%89%E5%A4%9A%E6%80%81%E6%80%A7/">扩展函数没有多态性</a><a class="post-meta__tags" href="/tags/%E5%8C%BF%E5%90%8D%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0/">匿名扩展函数</a><a class="post-meta__tags" href="/tags/%E5%8F%AF%E7%A9%BA%E6%8E%A5%E6%94%B6%E8%80%85/">可空接收者</a><a class="post-meta__tags" href="/tags/%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E4%BC%98%E5%85%88%E7%BA%A7%E5%A4%A7%E4%BA%8E%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0/">成员函数优先级大于扩展函数</a><a class="post-meta__tags" href="/tags/%E4%B8%AD%E7%BC%80%E8%A1%A8%E8%BE%BE%E5%BC%8F/">中缀表达式</a><a class="post-meta__tags" href="/tags/%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0/">可变参数</a><a class="post-meta__tags" href="/tags/vararg/">vararg</a><a class="post-meta__tags" href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a><a class="post-meta__tags" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">字符串正则表达式</a><a class="post-meta__tags" href="/tags/%E5%B1%80%E9%83%A8%E5%87%BD%E6%95%B0/">局部函数</a><a class="post-meta__tags" href="/tags/%E5%B1%80%E9%83%A8%E5%87%BD%E6%95%B0%E6%89%A9%E5%B1%95/">局部函数扩展</a></div><div class="social-share pull-right" data-disabled="google,facebook"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2022/12/03/07kotlin/%E4%B8%89%E3%80%81kotlin%E7%9A%84%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1(%E4%BA%8C)/"><i class="fa fa-chevron-left">  </i><span>三、kotlin的类和对象(二)</span></a></div><div class="next-post pull-right"><a href="/2022/12/03/07kotlin/%E4%B8%80%E3%80%81kotlin%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/"><span>一、kotlin基础语法学习</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2014 - 2022 By Bangiao</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">这是博客github仓库地址：<a target="_blank" rel="noopener" href="https://github.com/bangiao/bangiao.github.io">bangiao.github.io</a>，欢迎访问!</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.1"></script><script src="/js/fancybox.js?version=1.9.1"></script><script src="/js/sidebar.js?version=1.9.1"></script><script src="/js/copy.js?version=1.9.1"></script><script src="/js/fireworks.js?version=1.9.1"></script><script src="/js/transition.js?version=1.9.1"></script><script src="/js/scroll.js?version=1.9.1"></script><script src="/js/head.js?version=1.9.1"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>